<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/header :: head}"></head>

<body  class="bg-white">
    
    	<!-- --------------------------- [FRAGMENT : 상단 네이게이션바]  ------------------------------------->
        <div th:replace="~{fragments/top-nav :: top-nav}"></div>

        <div id="layoutSidenav">
            <div id="layoutSidenav_nav">
            </div>
            <div id="layoutSidenav_content">
                <main>
                	<!-- --------------------------- [FRAGMENT : 배너]  ------------------------------------->
                    <div th:replace="~{fragments/top-banner :: top-banner}"></div>


                    <!-- --------------------------- [중앙 : 컨텐츠 START]  ------------------------------------->
                    <div class="container-xl px-4 mt-n10">
                        
                        
                        <div class="card">
                            <div class="card-header border-bottom">
                                <!-- Wizard navigation-->

                                <div class="nav nav-pills nav-justified flex-column flex-xl-row nav-wizard" id="cardTab" role="tablist">
                                    
                                    <!-- 학생 회원가입  타이틀 -->
                                    <a class="nav-item nav-link active" id="wizard1-tab" href="#wizard1" data-bs-toggle="tab" role="tab" aria-controls="wizard1" aria-selected="true">
                                        <div class="wizard-step-icon">1</div>
                                        <div class="wizard-step-text">
                                            <div class="wizard-step-text-name">학생 회원가입</div>
                                            <div class="wizard-step-text-details">학생 계정으로 회원가입 합니다.</div>
                                        </div>
                                    </a>
                                    <!-- 선생님 회원가입 타이틀 -->
                                    <a class="nav-item nav-link" id="wizard2-tab" href="#wizard2" data-bs-toggle="tab" role="tab" aria-controls="wizard2" aria-selected="false" tabindex="-1">
                                        <div class="wizard-step-icon">2</div>
                                        <div class="wizard-step-text">
                                            <div class="wizard-step-text-name">선생님 회원가입</div>
                                            <div class="wizard-step-text-details">선생님 계정으로 회원가입 합니다.</div>
                                        </div>
                                    </a>

                                   
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="tab-content" id="cardTabContent">
                                    <!-- 학생 회원가입 폼 -->
                                    <div class="tab-pane py-2 py-xl-3 fade show active" id="wizard1" role="tabpanel" aria-labelledby="wizard1-tab">
                                        <div class="row justify-content-center">
                                            <div class="col-10"> 

                                                <form>
                                                    <div class="row gx-3">

                                                        <div class="mb-3 col-md-6">
                                                            <label class="middle mb-1"><b>닉네임을 입력하세요 (최대 20자)</b></label>
                                                            <div class="mb-3 d-flex align-items-center">
                                                                <input class="form-control me-2" style="width: 300px;" id="student-nickname" type="text" placeholder="닉네임">
                                                                <button class="btn btn-primary" style="width: auto;" id="nickname-duplicated-check-btn">중복확인</button>
                                                            </div>
                                                        </div>


                                                        <div class="mb-3 col-md-6">
                                                            <label class="middle mb-1"><b>학년을 입력하세요.</b></label>
                                                            <div class="mb-3 col-md-12">
                                                                <select name="mh" class="form-control">
                                                                    <option value="m1" selected="">중1</option>
                                                                    <option value="m2">중2</option>
                                                                    <option value="m3">중3</option>
                                                                    <option value="h1">고1</option>
                                                                    <option value="h2">고2</option>
                                                                    <option value="h3">고3</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="mb-3 col-md-12">
                                                        <label class="middle mb-1"><b>개인정보 수집동의 약관</b></label>
                                                           <div class="mb-3 col-md-12">
<textarea class="form-control" rows="20">개인정보 수집동의

개인정보는 ㅇㅇㅇㅇㅇㅇ 합니다.
개인정보는 ㅇㅇㅇㅇㅇㅇ 합니다.
개인정보는 ㅇㅇㅇㅇㅇㅇ 합니다.
</textarea>
                                                            </div>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input"  type="checkbox" value="" checked>
                                                        <label class="form-check-label" ><b>동의합니다.</b></label>
                                                    </div>
                                                    <hr class="my-4">
                                                    <div class="d-flex justify-content-center">
                                                        <button class="btn btn-primary" type="button">회원가입</button>
                                                    </div>
                                                    
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- 선생님 회원가입 폼 -->
                                    <div class="tab-pane py-2 py-xl-3 fade" id="wizard2" role="tabpanel" aria-labelledby="wizard2-tab">

                                        <div class="row justify-content-center">
                                            <div class="col-10">
                                                <form>
                                                    <div class="row gx-3">

                                                        <div class="mb-3 col-md-6">
                                                            <label class="middle mb-1"><b>닉네임을 입력하세요 (최대 20자)</b></label>
                                                            <div class="mb-3 d-flex align-items-center">
                                                                <input class="form-control me-2" style="width: 300px;" id="teacher-nickname" type="text" placeholder="닉네임">
                                                                <button class="btn btn-primary" style="width: auto;">중복확인</button>
                                                            </div>
                                                        </div>


                                                    <div class="mb-3 col-md-12">
                                                        <label class="middle mb-1"><b>개인정보 수집동의 약관</b></label>
                                                        <div class="mb-3 col-md-12">
<textarea class="form-control" rows="20">개인정보 수집동의

개인정보는 ㅇㅇㅇㅇㅇㅇ 합니다.
개인정보는 ㅇㅇㅇㅇㅇㅇ 합니다.
개인정보는 ㅇㅇㅇㅇㅇㅇ 합니다.
</textarea>
                                                        </div>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input"  type="checkbox" value="" checked>
                                                        <label class="form-check-label" ><b>동의합니다.</b></label>
                                                    </div>
                                                    <hr class="my-4">
                                                    <div class="d-flex justify-content-center">
                                                        <button class="btn btn-primary" type="button">회원가입</button>
                                                    </div>

                                                </form>
                                            </div>
                                        </div>


                                    </div>


                                </div>
                            </div>
                        </div>
                        
                        
                    </div>
                    <!-- --------------------------- [중앙 : 컨텐츠 END]  ------------------------------------->
                    
                    
                </main>



                <!-- --------------------------- [FRAGMENT : 하단] ------------------------------------->
                <footer th:replace="~{fragments/footer :: footer}"></footer>

            </div>
        </div>



        <!-- 공통 <script> 포함 -->
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <div th:replace="~{fragments/scripts :: scripts}" ></div>
      <script>
        $(document).ready(function () {
          const $nicknameInput = $('#student-nickname');
          const $checkButton = $('#nickname-duplicated-check-btn');

          $checkButton.on('click', function (event) {
            event.preventDefault();

            const nickname = $nicknameInput.val().trim();

            if (nickname === '') {
              alert('닉네임을 입력하세요.');
              return;
            }

            $.ajax({
              url: '/api/auth/nickname-duplicated',
              type: 'POST',
              contentType: 'application/json',
              data: JSON.stringify({ 'nickname': nickname }),
              success: function (response) {
                alert('사용 가능한 닉네임 입니다.');
                $checkButton.removeClass('btn-primary')
                .addClass('btn-success')
                .text('사용가능')
                .prop('disabled', true); // 버튼 비활성화
              },
              error: function (xhr) {
                if (xhr.status >= 400 && xhr.status < 500) {
                  const errorMessage = xhr.responseText || '클라이언트 오류가 발생했습니다.';
                  alert(errorMessage);
                } else {
                  alert('서버 오류가 발생했습니다.');
                }
              }
            });
          });

          // 닉네임 입력값이 변경될 때 버튼을 활성화하고 텍스트를 "중복확인"으로 변경
          $nicknameInput.on('input', function () {
            $checkButton.removeClass('btn-success')
            .addClass('btn-primary')
            .text('중복확인')
            .prop('disabled', false); // 버튼 활성화
          });
        });

      </script>


</body></html>